<!--
 * @Author: 一根鱼骨棒 Email 775639471@qq.com
 * @Date: 2025-04-18 11:48:55
 * @LastEditTime: 2025-11-08 17:48:46
 * @LastEditors: 一根鱼骨棒
 * @Description: 本开源代码使用GPL 3.0协议
 * Software: VScode
 * Copyright 2025 迷舍
-->


服务端安装resource中的软件

Cloudfare更改IP
在地球ONline中更改IP
在停车场服务的配置文件中更改IP
在企业微信中更改IP 设置可信IP

服务器根目录：C:\www\server\
## 安装openssl
## ssl证书说明
1.`duonline.top_bundle.pem`-包含证书和中间证书
2.`duonline.top.key`-包含私钥
## FileZilla_Server用于同步本地代码到服务器
创建账号sync 开通端口  打开passive mode


## python安装
更换源
```
pip config set global.index-url https://pypi.tuna.tsinghua.edu.cn/simple
```
<!-- hMailServer用于搭建邮件服务，cursor续杯需要  -->
## 停车场程序打包
在utils目录下运行 pyinstaller.exe build.spec
## rustdesk安装
用于中继远程桌面
1、nodjs安装
2、更换源
npm config set registry https://registry.npmmirror.com
3、安装 Windows 启动管理器 以管理员身份运行 CMD，执行
```
npm install -g pm2
npm install pm2-windows-startup -g
pm2-startup install
```

下载rustdesk安装
https://github.com/rustdesk/rustdesk-server/releases/download/1.1.14/rustdesk-server-windows-x86_64-unsigned.zip
       解压 官方服务端程序 至 C:\rustdesk-server

启动服务
```
cd C:\rustdesk-server
pm2 start hbbs.exe
pm2 start hbbr.exe
pm2 save  # 保存配置实现开机自启
pm2 list  # 验证服务状态应为"online"
```

找到key sMMJeWRSpPbXTiymxHmnoVd1paOn2NwMpgCQNjqETnM=

rustdesk-host=1.95.11.164,key=sMMJeWRSpPbXTiymxHmnoVd1paOn2NwMpgCQNjqETnM=,-qs.exe

开放端口TCP21115-21119
RustDesk 的 ID 注册（hbbs）依赖 UDP 21116 心跳，仅开 TCP 会导致客户端无法注册。

291421253/r@1.95.11.164?key=sMMJeWRSpPbXTiymxHmnoVd1paOn2NwMpgCQNjqETnM=


## frp安装 
内网穿透

服务端配置步骤
下载 frp
从 GitHub 发布页 下载对应 Windows 版本的压缩包（如 frp_0.48.0_windows_amd64.zip），解压到任意目录（例如 C:\frp）。
配置服务端 (frps.ini)
在解压目录中找到并编辑 frps.ini 文件，添加以下内容：
```ini
[common]
bind_port = 7000  # 服务端监听端口，客户端将连接此端口
token = 2025duonline  # 设置安全令牌，客户端需使用相同令牌
dashboard_port = 7500  # 控制台端口，可查看连接状态
dashboard_user = emanon  # 控制台用户名
dashboard_pwd = 325299  # 控制台密码
vhost_http_port = 8000

```
```yaml
common:
  bind_port: 7000       # 服务端监听端口
  token: your_token     # 安全令牌，客户端需匹配
  dashboard_port: 7500  # 管理界面端口
  dashboard_user: admin # 管理界面用户名
  dashboard_pwd: admin  # 管理界面密码
  vhost_http_port: 80   # HTTP 虚拟主机端口
  vhost_https_port: 443 # HTTPS 虚拟主机端口
```
启动服务端
打开命令提示符，切换到 frp 目录，执行：
```bash
frps -c frps.ini
```
若需后台运行，可使用工具如 nssm 将其安装为 Windows 服务。


客户端配置步骤
下载 frp 客户端
同样从 GitHub 下载 Windows 版本的 frp 压缩包，并解压到客户端电脑。
配置客户端 (frpc.ini)
编辑 frpc.ini，根据需求配置转发规则。以下是几个常见场景示例：
示例 1：远程桌面 (RDP) 访问
```ini

[common]
server_addr = your_server_ip  # 服务端公网 IP
server_port = 7000  # 服务端监听端口
token = your_token  # 与服务端相同的令牌

[rdp]
type = tcp
local_ip = 127.0.0.1
local_port = 3389  # 本地远程桌面端口
remote_port = 6000  # 服务端开放的访问端口
```
示例 2：Web 服务器转发
```ini
[common]
server_addr = your_server_ip
server_port = 7000
token = your_token

[web]
type = http
local_ip = 127.0.0.1
local_port = 80  # 本地 Web 服务器端口
custom_domains = your_domain.com  # 绑定的域名
```
```yaml
common:
  server_addr: your_server_ip  # 服务端公网 IP
  server_port: 7000            # 服务端监听端口
  token: your_token            # 与服务端相同的令牌

# 网站穿透配置示例
web:
  type: http                   # 协议类型
  local_ip: 127.0.0.1          # 本地 Web 服务器 IP
  local_port: 8080             # 本地 Web 服务器端口
  custom_domains: 
    - yourdomain.com           # 绑定的域名
    - www.yourdomain.com       # 多个域名支持

# HTTPS 穿透（可选，需要本地服务器支持 HTTPS）
web_https:
  type: https
  local_ip: 127.0.0.1
  local_port: 8443             # 本地 HTTPS 端口
  custom_domains:
    - yourdomain.com
  # 如果需要使用服务端 TLS 证书，取消注释以下行
  # tls_enable: true
```
启动客户端
在客户端命令提示符中执行：
```
frpc -c frpc.ini
```

